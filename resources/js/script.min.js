document.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(e.target.dataset.animate.split(" ").forEach(t=>e.target.classList.add(t)),t.unobserve(e.target))})},{root:null,threshold:.1,rootMargin:"0px"});document.querySelectorAll("[data-animate]").forEach(t=>e.observe(t));const t=document.getElementById("navigation"),n=document.getElementById("hamburger-btn"),o=document.querySelectorAll('a[href^="#"]'),c=()=>{const e=!t.classList.contains("active");t.classList.toggle("active"),n.classList.toggle("active"),n.setAttribute("aria-expanded",String(e)),document.body.style.overflow=t.classList.contains("active")?"hidden":""};n.addEventListener("click",c),document.addEventListener("click",e=>{!t.classList.contains("active")||t.contains(e.target)||n.contains(e.target)||c()});o.forEach(e=>{e.addEventListener("click",n=>{const o=e.getAttribute("href");if(!o.startsWith("#"))return;if(!document.querySelector(o))return;n.preventDefault();const a=t.classList.contains("active");a&&c();setTimeout(()=>((e,t)=>{const n=document.querySelector(e),o=window.pageYOffset,c=n.getBoundingClientRect(),a=(window.innerHeight-c.height)/2,s=c.top+o-a-o;let r=null;const i=e=>{null===r&&(r=e);const n=e-r,c=(a=n,l=o,d=s,(a/=t/2)<1?d/2*a*a+l:-d/2*(--a*(a-2)-1)+l);var a,l,d;window.scrollTo(0,c),n<t&&requestAnimationFrame(i)};requestAnimationFrame(i)})(o,800),a?300:0)})});const a=document.getElementById("intro-video"),s=window.innerWidth<768?"resources/media/Introwithsound-mobile.mp4":"resources/media/Introwithsound-desktop.mp4";a.innerHTML=`<source src="${s}" type="video/mp4">`,a.load(),a.play().catch(e=>console.warn("Autoplay probably blocked, but video is loaded.",e)),a.addEventListener("play",()=>{a.classList.add("played")});const r=document.querySelector(".carousel"),i=document.querySelectorAll(".carousel-item"),l=document.getElementById("left"),d=document.getElementById("right");let m=0;const u=()=>{const e=i[0].offsetWidth,t=r.offsetWidth,n=Math.round(-(e*m-t/2+e/2));r.style.transform=`translateX(${n}px)`,i.forEach(e=>e.classList.remove("active")),i[m]&&i[m].classList.add("active")};l.addEventListener("click",()=>{m>0&&(m--,u())}),d.addEventListener("click",()=>{m<i.length-1&&(m++,u())}),window.addEventListener("resize",u),u();document.getElementById("glassy-button").addEventListener("click",()=>{const e=document.getElementById("booking-appointment");e.classList.toggle("active"),e.classList.contains("active")?document.body.style.overflow="hidden":document.body.style.overflow=""}),document.getElementById("x-btn").addEventListener("click",()=>{const e=document.getElementById("booking-appointment");e.classList.remove("active"),e.classList.contains("active")?document.body.style.overflow="hidden":document.body.style.overflow=""});const h=(e,t)=>{const n=Number((e.filename||"").split("-")[1]);return(Number((t.filename||"").split("-")[1])||0)-(n||0)},g=(e,t)=>{const n=e.title||t||"Photo";return`<img src="${e.url}?v=${Date.now()}" alt="${n}" loading="lazy" />`};fetch("/api/photos?section=gallery").then(e=>e.json()).then(e=>{e.sort(h);const t=document.getElementById("photo-gallery");e.forEach(e=>{const n=document.createElement("figure");n.className="photo-card",n.innerHTML=`\n            ${g(e,"Tattoo Photo")}\n          <article class="card-description">\n            <h2>${e.title||"New Ink"}</h2>\n            <p>${e.style||""}</p>\n          </article>\n          `,t.prepend(n)})}).catch(e=>console.error("Gallery load failed:",e)),fetch("/api/photos?section=popular").then(e=>e.json()).then(e=>{e.sort(h);const t=document.getElementById("popular-gallery-container");e.forEach(e=>{const n=document.createElement("figure");n.className="gallery-item",n.innerHTML=g(e,"Tattoo photo"),t.prepend(n)})}).catch(e=>console.error("Gallery load failed:",e)),fetch("/api/photos?section=awards").then(e=>e.json()).then(e=>{const t=document.getElementById("carousel-inner");e.forEach(e=>{const n=document.createElement("div");n.className="carousel-item",n.innerHTML=`\n          <figure class="carousel-img-container">\n            ${g(e,"Award")}\n          </figure>\n          <article class="award-description">\n            <p>${e.title||""}</p>\n          </article>\n        `,t.prepend(n)})}).catch(e=>console.error("Gallery load failed:",e))});